{"ast":null,"code":"import _objectSpread from\"/Users/isaacson/Projects/invester/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{setActiveDashboard,toggleModalOpen}from\"../../store/global\";import{Copy,ArrowRight,Package}from\"react-feather\";import{AVAILABLE_WIDGETS}from\"../../constants/config\";import{v4 as uuidv4}from\"uuid\";import{useBoard}from\"../../hooks/useBoard\";import{useDashboard}from\"../../hooks/useDashboard\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function AddWidget(){const global=useSelector(state=>state);const dispatch=useDispatch();if(!global.modalOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"addWidgetModalBackDrop\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"addWidgetModal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"addWidgetModalHeader\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Copy,{size:12,color:\"orange\",style:{marginRight:10}}),\"Add New Widget\"]}),/*#__PURE__*/_jsx(\"div\",{onClick:()=>{dispatch(toggleModalOpen(false));},className:\"closeButton\",children:\"Cancel\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"addWidgetModalContent\",children:[AVAILABLE_WIDGETS.map((widget,index)=>{return/*#__PURE__*/_jsx(WidgetBox,{data:widget},index);}),/*#__PURE__*/_jsx(\"p\",{style:{padding:20},children:\"To add the widget box of your choice to the board, simply select one from the options provided above.\"})]})]})});}const WidgetBox=_ref=>{var _data$options;let{data}=_ref;const[symbol,setSymbol]=useState(\"BTCUSDT\");const[channel,setChannel]=useState(\"CNBC\");const{save}=useBoard();const global=useSelector(state=>state);const dispatch=useDispatch();const{getLocalDashboards}=useDashboard();async function handleAddWidget(data){const newId=uuidv4();const newLayoutItemItem={w:6,h:4,x:0,y:Infinity,i:newId,moved:false,static:false};const newWidgetItem=_objectSpread({i:newId,type:data.type_id,symbol:symbol},data.type_id===\"TVBox\"?{channel:channel}:{});if(global.activeDashboard===\"home\"){save({layout:[...global.layouts,newLayoutItemItem],widgets:[...global.widgets,newWidgetItem]});}else{const localDashboards=await getLocalDashboards();const thisDashboard=localDashboards.filter(dashB=>dashB.id===global.activeDashboard)[0];save({layout:[...thisDashboard.layouts,...[newLayoutItemItem]],widgets:[...thisDashboard.widgets,...[newWidgetItem]]});dispatch(setActiveDashboard(\"home\"));dispatch(setActiveDashboard(thisDashboard.id));}dispatch(toggleModalOpen(false));}return/*#__PURE__*/_jsxs(\"div\",{className:\"WidgetBox\",\"data-testid\":\"AddNewWidgetModal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col\",children:[/*#__PURE__*/_jsx(Package,{}),\" \",/*#__PURE__*/_jsx(ArrowRight,{color:\"orange\",size:12,style:{marginRight:20}}),\" \",data.name]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col\",children:[data.requirements.length>0&&data.requirements[0]===\"symbol\"&&/*#__PURE__*/_jsx(\"input\",{placeholder:\"Symbol\",className:\"addWidgetSymbolInput\",value:symbol,onChange:e=>{setSymbol(e.target.value);}}),data.requirements.length>0&&data.requirements[0]===\"select\"&&/*#__PURE__*/_jsx(\"select\",{onChange:e=>{setChannel(e.target.value);},children:(_data$options=data.options)===null||_data$options===void 0?void 0:_data$options.map((opt,index)=>{return/*#__PURE__*/_jsx(\"option\",{value:opt,children:opt},index);})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:/*#__PURE__*/_jsx(\"button\",{className:\"addWidgetButton\",onClick:()=>{handleAddWidget(data);},children:\"Add\"})})]});};","map":{"version":3,"names":["useState","useDispatch","useSelector","setActiveDashboard","toggleModalOpen","Copy","ArrowRight","Package","AVAILABLE_WIDGETS","v4","uuidv4","useBoard","useDashboard","jsx","_jsx","jsxs","_jsxs","AddWidget","global","state","dispatch","modalOpen","className","children","size","color","style","marginRight","onClick","map","widget","index","WidgetBox","data","padding","_ref","_data$options","symbol","setSymbol","channel","setChannel","save","getLocalDashboards","handleAddWidget","newId","newLayoutItemItem","w","h","x","y","Infinity","i","moved","static","newWidgetItem","_objectSpread","type","type_id","activeDashboard","layout","layouts","widgets","localDashboards","thisDashboard","filter","dashB","id","name","requirements","length","placeholder","value","onChange","e","target","options","opt"],"sources":["/Users/isaacson/Projects/invester/src/components/Layout/AddWidget.tsx"],"sourcesContent":["import { useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n    GlobalData,\n    setActiveDashboard,\n    toggleModalOpen,\n} from \"../../store/global\";\nimport { Copy, ArrowRight, Package } from \"react-feather\";\nimport { AVAILABLE_WIDGETS } from \"../../constants/config\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { useBoard } from \"../../hooks/useBoard\";\nimport { useDashboard } from \"../../hooks/useDashboard\";\n\nexport default function AddWidget() {\n    const global: GlobalData = useSelector((state: GlobalData) => state);\n    const dispatch = useDispatch();\n\n    if (!global.modalOpen) return null;\n    return (\n        <div className=\"addWidgetModalBackDrop\">\n            <div className=\"addWidgetModal\">\n                <div className=\"addWidgetModalHeader\">\n                    <div>\n                        <Copy\n                            size={12}\n                            color=\"orange\"\n                            style={{ marginRight: 10 }}\n                        />\n                        Add New Widget\n                    </div>\n                    <div\n                        onClick={() => {\n                            dispatch(toggleModalOpen(false));\n                        }}\n                        className=\"closeButton\"\n                    >\n                        Cancel\n                    </div>\n                </div>\n                <div className=\"addWidgetModalContent\">\n                    {AVAILABLE_WIDGETS.map((widget, index) => {\n                        return <WidgetBox key={index} data={widget} />;\n                    })}\n                    <p style={{ padding: 20 }}>\n                        To add the widget box of your choice to the board,\n                        simply select one from the options provided above.\n                    </p>\n                </div>\n            </div>\n        </div>\n    );\n}\nconst WidgetBox = ({\n    data,\n}: {\n    data: {\n        name: string;\n        type_id: string;\n        requirements: string[];\n        options?: string[];\n    };\n}) => {\n    const [symbol, setSymbol] = useState(\"BTCUSDT\");\n    const [channel, setChannel] = useState(\"CNBC\");\n    const { save } = useBoard();\n    const global = useSelector((state: GlobalData) => state);\n    const dispatch = useDispatch();\n    const { getLocalDashboards } = useDashboard();\n\n    async function handleAddWidget(data: {\n        name: string;\n        type_id: string;\n        options?: string[];\n        requirements: string[];\n    }) {\n        const newId = uuidv4();\n        const newLayoutItemItem = {\n            w: 6,\n            h: 4,\n            x: 0,\n            y: Infinity,\n            i: newId,\n            moved: false,\n            static: false,\n        };\n        const newWidgetItem = {\n            i: newId,\n            type: data.type_id,\n            symbol: symbol,\n            ...(data.type_id === \"TVBox\" ? { channel: channel } : {}),\n        };\n\n        if (global.activeDashboard === \"home\") {\n            save({\n                layout: [...global.layouts, newLayoutItemItem],\n                widgets: [...global.widgets, newWidgetItem],\n            });\n        } else {\n            const localDashboards = await getLocalDashboards();\n            const thisDashboard = localDashboards.filter(\n                (dashB) => dashB.id === global.activeDashboard\n            )[0];\n            save({\n                layout: [...thisDashboard.layouts, ...[newLayoutItemItem]],\n                widgets: [...thisDashboard.widgets, ...[newWidgetItem]],\n            });\n            dispatch(setActiveDashboard(\"home\"));\n            dispatch(setActiveDashboard(thisDashboard.id));\n        }\n\n        dispatch(toggleModalOpen(false));\n    }\n\n    return (\n        <div className=\"WidgetBox\" data-testid=\"AddNewWidgetModal\">\n            <div className=\"col\">\n                <Package />{\" \"}\n                <ArrowRight\n                    color=\"orange\"\n                    size={12}\n                    style={{ marginRight: 20 }}\n                />{\" \"}\n                {data.name}\n            </div>\n            <div className=\"col\">\n                {data.requirements.length > 0 &&\n                    data.requirements[0] === \"symbol\" && (\n                        <input\n                            placeholder=\"Symbol\"\n                            className=\"addWidgetSymbolInput\"\n                            value={symbol}\n                            onChange={(e) => {\n                                setSymbol(e.target.value);\n                            }}\n                        />\n                    )}\n                {data.requirements.length > 0 &&\n                    data.requirements[0] === \"select\" && (\n                        <select\n                            onChange={(e) => {\n                                setChannel(e.target.value);\n                            }}\n                        >\n                            {data.options?.map((opt, index) => {\n                                return (\n                                    <option key={index} value={opt}>\n                                        {opt}\n                                    </option>\n                                );\n                            })}\n                        </select>\n                    )}\n            </div>\n            <div className=\"col\">\n                <button\n                    className=\"addWidgetButton\"\n                    onClick={() => {\n                        handleAddWidget(data);\n                    }}\n                >\n                    Add\n                </button>\n            </div>\n        </div>\n    );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}